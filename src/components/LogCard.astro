---
import { getLangFromUrl, useTranslations, getBasePath } from '../utils/i18n';

interface Props {
  title: string;
  excerpt: string;
  date: Date;
  slug: string;
  tags?: string[];
  section?: string;
}

const { title, excerpt, date, slug, tags, section = 'log' } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const basePath = getBasePath(lang);
---

<article class="log-card">
  <time datetime={date.toISOString()}>
    {date.toLocaleDateString(lang === 'ko' ? 'ko-KR' : 'en-US', { 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    })}
  </time>
  
  <h2>
    <a href={`${basePath}/${section}/${slug}`}>{title}</a>
  </h2>
  
  <p class="excerpt">{excerpt}</p>
  
  {tags && tags.length > 0 && (
    <div class="tags">
      {tags.map((tag) => (
        <span class="tag">{tag}</span>
      ))}
    </div>
  )}
  
  <a href={`${basePath}/${section}/${slug}`} class="read-more">
    {t('log.readMore')} â†’
  </a>
</article>

<style>
  .log-card {
    border: 1px solid #e5e5e5;
    border-radius: 8px;
    padding: clamp(1.25rem, 1rem + 1.25vw, 1.75rem);
    transition: box-shadow 0.2s, transform 0.2s;
    background: white;
  }

  .log-card:hover {
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
    transform: translateY(-4px);
  }

  .log-card time {
    color: #666;
    font-size: clamp(0.875rem, 0.85rem + 0.125vw, 0.9375rem);
    display: block;
    margin-bottom: clamp(0.375rem, 0.3rem + 0.375vw, 0.5rem);
  }

  .log-card h2 {
    font-size: clamp(1.25rem, 1.15rem + 0.5vw, 1.625rem);
    margin: clamp(0.5rem, 0.4rem + 0.5vw, 0.75rem) 0;
    line-height: 1.3;
  }

  .log-card h2 a {
    text-decoration: none;
    color: #000;
    transition: color 0.2s;
    /* Better touch target */
    display: block;
    padding: 0.25rem 0;
    min-height: auto;
  }

  .log-card h2 a:hover {
    color: #667eea;
  }

  .excerpt {
    color: #555;
    line-height: 1.65;
    margin-bottom: clamp(1rem, 0.8rem + 1vw, 1.25rem);
    font-size: clamp(0.9375rem, 0.9rem + 0.1875vw, 1.0625rem);
  }

  .tags {
    display: flex;
    gap: clamp(0.375rem, 0.3rem + 0.375vw, 0.5rem);
    flex-wrap: wrap;
    margin-bottom: clamp(1rem, 0.8rem + 1vw, 1.25rem);
  }

  .tag {
    background: #f0f0f0;
    padding: clamp(0.25rem, 0.2rem + 0.25vw, 0.375rem) clamp(0.625rem, 0.55rem + 0.375vw, 0.875rem);
    border-radius: 4px;
    font-size: clamp(0.8125rem, 0.8rem + 0.0625vw, 0.875rem);
    color: #555;
    font-weight: 500;
  }

  .read-more {
    color: #667eea;
    text-decoration: none;
    font-weight: 600;
    transition: color 0.2s;
    font-size: clamp(0.9375rem, 0.9rem + 0.1875vw, 1.0625rem);
    /* Better touch target */
    display: inline-block;
    padding: 0.25rem 0;
    min-height: 44px;
    line-height: 1.5;
  }

  .read-more:hover {
    color: #764ba2;
    text-decoration: underline;
  }
</style>
